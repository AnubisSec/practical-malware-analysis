This post is part of the series of [Practical Malware Analysis Exercises.](../index.md)


## 1) How can it be installed?
 
## Initial static analysis

- This dll exports uninstall, install, ServiceMain, and UninstallService
- These exports imply this needs to be installed
- Looking at the imports, looks like it will probably create a service on the target, and you probably need to do that through using the `Install` export with `rundll32.exe`
- Strings and imports seem to imply it will touch some registry keys. Also it may reach out to the internet, but my guess is that the service will do this, and not the dll itself.



## Dynamic analysis

- We will first start by running the dll using `rundll32.exe`, after doing a regshot snapshot since the strings imply registry editing.

![Lab03-2-rundll](../images/Lab03-2-rundll.PNG)

- Didn't seem to work due to the following error:

```text
Faulting application name: rundll32.exe, version: 10.0.16299.15, time stamp: 0xb329203b
Faulting module name: Lab03-02.dll, version: 0.0.0.0, time stamp: 0x4ca13e29
Exception code: 0xc0000005
Fault offset: 0x0000473f
Faulting process id: 0xcc
Faulting application start time: 0x01d655825fa5add2
Faulting application path: C:\WINDOWS\SysWOW64\rundll32.exe
Faulting module path: C:\Users\REM\Desktop\Practical Malware Analysis Labs\BinaryCollection\Chapter_3L\Lab03-02.dll
Report Id: 3ff40154-fed6-4166-bf9b-a34f0fecf850
Faulting package full name: 
Faulting package-relative application ID: 
```


## 2) How would it be run after installation?

- After installing this you could check for any new services, and start them while monitoring any processes.



## 3) How can the process be found?

- Once you started the service,  you could use ProcessHacker to find the process.
- ProcessHacker would show a `svchost.exe` running, and you would have to find one that mentions "Lab03-02.dll"



## 4) Filters for ProcMon?

- You could filter ProcMon for "PID is <PID from ProcessHacker you found previously"


## 5) Host based indicators?

- *The registry keys altered*
- *The service "RIPIP"*



## 6) Network based indicators?

- *practicalmalwareanalysis.com*
- *serve.html*